<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ownership Recap - The Rust Programming Language</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="ferris.css">
        <link rel="stylesheet" href="theme/semantic-notes.css">
        <link rel="stylesheet" href="theme/listing.css">
        <link rel="stylesheet" href="theme/2018-edition.css">
        <link rel="stylesheet" href="js-extensions/packages/consent-form/dist/index.css">
        <link rel="stylesheet" href="js-extensions/packages/feedback/dist/index.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust Programming Language</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cognitive-engineering-lab/rust-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="ownership-recap"><a class="header" href="#ownership-recap">Ownership Recap</a></h2>
<p>This chapter introduced a lot of new concepts like ownership, borrowing, and slices.
If you aren’t familiar with systems programming, this chapter also introduced new concepts like memory allocation, the stack vs. the heap, pointers, and undefined behavior. Before we move on to the rest of Rust, let’s first stop and take a breath. We’ll review and practice with the key concepts from this chapter.</p>
<h3 id="ownership-versus-garbage-collection"><a class="header" href="#ownership-versus-garbage-collection">Ownership versus Garbage Collection</a></h3>
<p>To put ownership into context, we should talk about <strong>garbage collection</strong>.
Most programming languages use a garbage collector to manage memory, such as in Python, Javascript, Java, and Go. A garbage collector works at runtime adjacent to a running program (a tracing collector, at least). The collector scans through memory to find data that’s no longer used — that is, the running program can no longer reach that data from a function-local variable. Then the collector deallocates the unused memory for later use.</p>
<p>The key benefit of a garbage collector is that it avoids undefined behavior (such as using freed memory), as can happen in C or C++. Garbage collection also avoids the need for a complex type system to check for undefined behavior, like in Rust. However, there are a few drawbacks to garbage collection. One obvious drawback is performance, as garbage collection incurs either frequent small overheads (for reference-counting, like in Python and Swift) or infrequent large overheads (for tracing, like in all other GC’d languages).</p>
<p>But another less obvious drawback is that <strong>garbage collection can be unpredictable</strong>. To illustrate the point, say we are implementing a <code>Document</code> type that represents a mutable list of words. We could implement <code>Document</code> in a garbage-collected language such as Python in this way:</p>
<pre><code class="language-python">class Document:     
    def __init__(self, words: List[str]):
        """Create a new document"""
        self.words = words

    def add_word(self, word: str):
        """Add a word to the document"""
        self.words.append(word)
        
    def get_words(self) -&gt; List[str]:  
        """Get a list of all the words in the document"""
        return self.words
</code></pre>
<p>Here’s one way we could use this <code>Document</code> class that creates a document <code>d</code>, copies it into a new document <code>d2</code>, and then mutates <code>d2</code>.</p>
<pre><code class="language-python">words = ["Hello"]
d = Document(words)

d2 = Document(d.get_words())
d2.add_word("world")
</code></pre>
<p>Consider two key questions about this example:</p>
<ol>
<li>
<p><strong>When is the words array deallocated?</strong>
This program has created three pointers to the same array. The variables <code>words</code>, <code>d</code>, and <code>d2</code> all contain a pointer to the words array allocated on the heap. Therefore Python will only deallocate the words array when all three variables are out of scope. More generally, it’s often difficult to predict where data will be garbage-collected just by reading the source code.</p>
</li>
<li>
<p><strong>What are the contents of the document <code>d</code>?</strong>
Because <code>d2</code> contains a pointer to the same words array as <code>d</code>, then <code>d2.add_word("world")</code> also mutates the document <code>d</code>. Therefore in this example, the words in <code>d</code> are <code>["Hello", "world"]</code>. This happens because <code>d.get_words()</code> returns a mutable reference to the words array in <code>d</code>. Pervasive, implicit mutable references can easily lead to unpredictable bugs when data structures can leak their internals<sup class="footnote-reference" id="fr-ownership-originally-1"><a href="#footnote-ownership-originally">1</a></sup>. Here, it is probably not intended behavior that a change to <code>d2</code> can change <code>d</code>.</p>
</li>
</ol>
<p>This problem is not unique to Python — you can encounter similar behavior in C#, Java, Javascript, and so on. In fact, most programming languages actually have a concept of pointers. It’s just a question of how the language exposes pointers to the programmer. Garbage collection makes it difficult to see which variable points to which data. For example, it wasn’t obvious that <code>d.get_words()</code> produced a pointer to data within <code>d</code>.</p>
<p>By contrast, Rust’s ownership model puts pointers front-and-center. We can see that by translating the <code>Document</code> type into a Rust data structure. Normally we would use a <code>struct</code>, but we haven’t covered those yet, so we’ll just use a type alias:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>type Document = Vec&lt;String&gt;;

fn new_document(words: Vec&lt;String&gt;) -&gt; Document {
    words
}

fn add_word(this: &amp;mut Document, word: String) {
    this.push(word);
}

fn get_words(this: &amp;Document) -&gt; &amp;[String] {
    this.as_slice()
}
<span class="boring">}</span></code></pre></pre>
<p>This Rust API differs from the Python API in a few key ways:</p>
<ul>
<li>
<p>The function <code>new_document</code> consumes ownership of the input vector <code>words</code>. That means the <code>Document</code> <em>owns</em> the word vector. The word vector will be predictably deallocated when its owning <code>Document</code> goes out of scope.</p>
</li>
<li>
<p>The function <code>add_word</code> requires a mutable reference <code>&amp;mut Document</code> to be able to mutate a document. It also consumes ownership of the input <code>word</code>, meaning no one else can mutate the individual words of the document.</p>
</li>
<li>
<p>The function <code>get_words</code> returns an explicit immutable reference to strings within the document. The only way to create a new document from this word vector is to deep-copy its contents, like this:</p>
</li>
</ul>
<pre><code class="language-rust ignore">fn main() {
    let words = vec!["hello".to_string()];
    let d = new_document(words);

    // .to_vec() converts &amp;[String] to Vec&lt;String&gt; by cloning each string
    let words_copy = get_words(&amp;d).to_vec();
    let mut d2 = new_document(words_copy);
    add_word(&amp;mut d2, "world".to_string());

    // The modification to `d2` does not affect `d`
    assert!(!get_words(&amp;d).contains(&amp;"world".into()));
}</code></pre>
<p>The point of this example is to say: if Rust is not your first language, then you already have experience working with memory and pointers! Rust just makes those concepts explicit. This has the dual benefit of (1) improving runtime performance by avoiding garbage collection, and (2) improving predictability by preventing accidental “leaks” of data.</p>
<h3 id="the-concepts-of-ownership"><a class="header" href="#the-concepts-of-ownership">The Concepts of Ownership</a></h3>
<p>Next, let’s review the concepts of ownership. This review will be quick — the goal is to remind you of the relevant concepts. If you realize you forgot or didn’t understand a concept, then we will link you to the relevant chapters which you can review.</p>
<h4 id="ownership-at-runtime"><a class="header" href="#ownership-at-runtime">Ownership at Runtime</a></h4>
<p>We’ll start by reviewing how Rust uses memory at runtime:</p>
<ul>
<li>Rust allocates local variables in stack frames, which are allocated when a function is called and deallocated when the call ends.</li>
<li>Local variables can hold either data (like numbers, booleans, tuples, etc.) or pointers.</li>
<li>Pointers can be created either through boxes (pointers owning data on the heap) or references (non-owning pointers).</li>
</ul>
<p>This diagram illustrates how each concept looks at runtime:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\n  let mut a_num = 0;\n  inner(&amp;mut a_num);\n}\n\nfn inner(x: &amp;mut i32) {\n  let another_num = 1;\n  let a_stack_ref = &amp;another_num;\n\n  let a_box = Box::new(2);  \n  let a_box_stack_ref = &amp;a_box;\n  let a_box_heap_ref = &amp;*a_box;\n\n  *x += 5;\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[],&quot;interp&quot;:{&quot;state_locations&quot;:[53,231]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;interpreter&quot;]" data-responses="{&quot;interpreter&quot;:{&quot;Ok&quot;:{&quot;result&quot;:{&quot;type&quot;:&quot;Success&quot;},&quot;steps&quot;:[{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:0},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:1}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:21,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:22,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:6}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;another_num&quot;}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:33,&quot;line&quot;:7},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:7}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;another_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Box&quot;},&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Box&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:26,&quot;line&quot;:9},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:9}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;another_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Box&quot;},&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Box&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;a_box&quot;}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:31,&quot;line&quot;:10},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:10}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:0}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;another_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Box&quot;},&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Box&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;a_box&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box_heap_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:31,&quot;line&quot;:11},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:11}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:5}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;another_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;another_num&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Box&quot;},&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Box&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box_stack_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:1,&quot;local&quot;:&quot;a_box&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_box_heap_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:10,&quot;line&quot;:13},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:13}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:5}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;},{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;x&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;a_num&quot;}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:14},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:14}},&quot;name&quot;:&quot;inner&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;a_num&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:5}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;name&quot;:&quot;main&quot;}]}}]}}}" data-config="{&quot;horizontal&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>Review this diagram and make sure you understand each part. For example, you should be able to answer:</p>
<ul>
<li>Why does <code>a_box_stack_ref</code> point to the stack, while <code>a_box_heap_ref</code> point to the heap?</li>
<li>Why is the value <code>2</code> no longer on the heap at L2?</li>
<li>Why does <code>a_num</code> have the value <code>5</code> at L2?</li>
</ul>
<p>If you want to review boxes, re-read <a href="ch04-01-what-is-ownership.html">Chapter 4.1</a>. If you want to review references, re-read <a href="ch04-02-references-and-borrowing.html">Chapter 4.2</a>. If you want to see case studies involving boxes and references, re-read <a href="ch04-03-fixing-ownership-errors.html">Chapter 4.3</a>.</p>
<p>Slices are a special kind of reference that refer to a contiguous sequence of data in memory. This diagram illustrates how a slice refers to a subsequence of characters in a string:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\n  let s = String::from(\&quot;abcdefg\&quot;);\n  let s_slice = &amp;s[2..5];\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[],&quot;interp&quot;:{&quot;state_locations&quot;:[72]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;interpreter&quot;]" data-responses="{&quot;interpreter&quot;:{&quot;Ok&quot;:{&quot;result&quot;:{&quot;type&quot;:&quot;Success&quot;},&quot;steps&quot;:[{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:0},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:97},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:98},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:99},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:100},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:101},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:102},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:103}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;s&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;String&quot;,&quot;value&quot;:{&quot;len&quot;:7}},&quot;fields&quot;:[[&quot;vec&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:7}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:7}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;String&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:1}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:97},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:98},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:99},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:100},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:101},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:102},{&quot;type&quot;:&quot;Char&quot;,&quot;value&quot;:103}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;s&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;String&quot;,&quot;value&quot;:{&quot;len&quot;:7}},&quot;fields&quot;:[[&quot;vec&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:7}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:7}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;String&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;s_slice&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Subslice&quot;,&quot;value&quot;:[2,4]}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:3}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:25,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;name&quot;:&quot;main&quot;}]}}]}}}" data-config="{}" data-no-interact="true"></div>
<p>If you want to review slices, re-read <a href="ch04-04-slices.html">Chapter 4.4</a>.</p>
<h4 id="ownership-at-compile-time"><a class="header" href="#ownership-at-compile-time">Ownership at Compile-time</a></h4>
<p>Rust tracks <span class="perm read">R</span> (read), <span class="perm write">W</span> (write), and <span class="perm own">O</span> (own) permissions on each variable. Rust requires that a variable has appropriate permissions to perform a given operation. As a basic example, if a variable is not declared as <code>let mut</code>, then it is missing the <span class="perm write">W</span> permission and cannot be mutated:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\n  let n = 0;\n  n += 1;\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:false,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:true,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}}],&quot;loan_points&quot;:{},&quot;loan_regions&quot;:{},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:12,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:7,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:6,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;n&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:8,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}}}]}]}}]}" data-config="{&quot;boundaries&quot;:&quot;true&quot;,&quot;shouldFail&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>A variable’s permissions can be changed if it is <strong>moved</strong> or <strong>borrowed</strong>. A move of a variable with a non-copyable type (like <code>Box&lt;T&gt;</code> or <code>String</code>) requires the <span class="perm read">R</span><span class="perm own">O</span> permissions, and the move eliminates all permissions on the variable. That rule prevents the use of moved variables:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\n  let s = String::from(\&quot;Hello world\&quot;);\n  consume_a_string(s);\n  println!(\&quot;{s}\&quot;); // can't read `s` after moving it\n}\n\nfn consume_a_string(_s: String) {\n  // om nom nom\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:19,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:false,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_moved&quot;:0,&quot;path_uninitialized&quot;:true,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:13,&quot;line&quot;:3}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:3}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:3}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:22,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:22,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:21,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:22,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:21,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:38,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:38,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:7,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:6,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:21,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:2,&quot;line&quot;:2}}}]}]}},{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:8},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:6}},&quot;boundaries&quot;:[],&quot;loan_points&quot;:{},&quot;loan_regions&quot;:{},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[]}}]}" data-config="{&quot;shouldFail&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;,&quot;boundaries&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>If you want to review how moves work, re-read <a href="ch04-01-what-is-ownership.html">Chapter 4.1</a>.</p>
<p>Borrowing a variable (creating a reference to it) temporarily removes some of the variable’s permissions. An immutable borrow creates an immutable reference, and also disables the borrowed data from being mutated or moved. For example, printing an immutable reference is ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;s;\nprintln!(\&quot;{s_ref}\&quot;);\nprintln!(\&quot;{s}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:13,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:true,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:11,&quot;line&quot;:3}},{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:11,&quot;line&quot;:4}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;3&quot;:{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}},&quot;4&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}},&quot;3&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:3}},&quot;4&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:4}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:15,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:16,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:16,&quot;line&quot;:4}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:20,&quot;line&quot;:3}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]}]}}]}" data-config="{&quot;boundaries&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>But mutating an immutable reference is not ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;s;\ns_ref.push_str(\&quot; world\&quot;);\nprintln!(\&quot;{s}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[3],&quot;focused_paths&quot;:{&quot;3&quot;:[{&quot;type&quot;:&quot;Literal&quot;,&quot;value&quot;:&quot;*s_ref&quot;}]}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:13,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:false,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:5,&quot;line&quot;:3}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:15,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]}]}}]}" data-config="{&quot;stepper&quot;:&quot;true&quot;,&quot;boundaries&quot;:&quot;true&quot;,&quot;shouldFail&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>And mutating the immutably borrowed data is not ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;s;\ns.push_str(\&quot; world\&quot;);\nprintln!(\&quot;{s_ref}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[2,3],&quot;focused_paths&quot;:{&quot;3&quot;:[{&quot;type&quot;:&quot;Regex&quot;,&quot;value&quot;:&quot;s$&quot;}]}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:13,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;loan_drop_refined&quot;:0,&quot;loan_write_refined&quot;:0,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:1,&quot;line&quot;:3}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}},&quot;3&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:17,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}},&quot;3&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:3}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:15,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:20,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]}]}}]}" data-config="{&quot;shouldFail&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;,&quot;boundaries&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>And moving data out of the reference is not ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;s;\nlet s2 = *s_ref;\nprintln!(\&quot;{s}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[3],&quot;focused_paths&quot;:{&quot;3&quot;:[{&quot;type&quot;:&quot;Literal&quot;,&quot;value&quot;:&quot;*s_ref&quot;}]}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:13,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:false,&quot;type_writeable&quot;:false},&quot;expected&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:9,&quot;line&quot;:3}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:9,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:15,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:6,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:3}}}]}]}}]}" data-config="{&quot;shouldFail&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;,&quot;boundaries&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>A mutable borrow creates a mutable reference, which disables the borrowed data from being read, written, or moved. For example, mutating a mutable reference is ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;mut s;\ns_ref.push_str(\&quot; world\&quot;);\nprintln!(\&quot;{s}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:17,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:false,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:5,&quot;line&quot;:3}},{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:11,&quot;line&quot;:4}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:18,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:5,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}},&quot;3&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:18,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}},&quot;3&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:3}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:19,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:25,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:25,&quot;line&quot;:3}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:25,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:24,&quot;line&quot;:3}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:16,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:16,&quot;line&quot;:4}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:25,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:24,&quot;line&quot;:3}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]}]}}]}" data-config="{&quot;boundaries&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>But accessing the mutably borrowed data is not ok:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut s = String::from(\&quot;Hello\&quot;);\nlet s_ref = &amp;mut s;\nprintln!(\&quot;{s}\&quot;);\ns_ref.push_str(\&quot; world\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[3],&quot;focused_paths&quot;:{&quot;3&quot;:[{&quot;type&quot;:&quot;Regex&quot;,&quot;value&quot;:&quot;s$&quot;}]}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;permissions&quot;]" data-responses="{&quot;permissions&quot;:[{&quot;Ok&quot;:{&quot;body_range&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;boundaries&quot;:[{&quot;actual&quot;:{&quot;drop&quot;:true,&quot;read&quot;:true,&quot;write&quot;:true},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:true},&quot;location&quot;:{&quot;column&quot;:17,&quot;line&quot;:2}},{&quot;actual&quot;:{&quot;drop&quot;:false,&quot;read&quot;:false,&quot;write&quot;:false},&quot;data&quot;:{&quot;is_live&quot;:true,&quot;loan_drop_refined&quot;:0,&quot;loan_read_refined&quot;:0,&quot;loan_write_refined&quot;:0,&quot;path_uninitialized&quot;:false,&quot;type_copyable&quot;:false,&quot;type_droppable&quot;:true,&quot;type_writeable&quot;:true},&quot;expected&quot;:{&quot;drop&quot;:false,&quot;read&quot;:true,&quot;write&quot;:false},&quot;location&quot;:{&quot;column&quot;:11,&quot;line&quot;:3}}],&quot;loan_points&quot;:{&quot;0&quot;:{&quot;end&quot;:{&quot;column&quot;:18,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},&quot;1&quot;:{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}},&quot;2&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;3&quot;:{&quot;end&quot;:{&quot;column&quot;:5,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}},&quot;loan_regions&quot;:{&quot;0&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:18,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:12,&quot;line&quot;:2}},{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}},{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:0}},&quot;1&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:13,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:10,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:1}},&quot;2&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:2}},&quot;3&quot;:{&quot;refined_ranges&quot;:[{&quot;end&quot;:{&quot;column&quot;:24,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}}],&quot;refiner_point&quot;:{&quot;Loan&quot;:3}}},&quot;move_points&quot;:{},&quot;move_regions&quot;:{},&quot;steps&quot;:[{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:34,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:34,&quot;line&quot;:1}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:1}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}}}]},{&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:19,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:19,&quot;line&quot;:2}},&quot;state&quot;:[{&quot;from&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:4,&quot;line&quot;:2}},&quot;state&quot;:[[&quot;s&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:0},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;read&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;write&quot;:{&quot;type&quot;:&quot;Low&quot;}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}],[&quot;s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;Low&quot;},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false}}],[&quot;*s_ref&quot;,{&quot;is_live&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;loan_drop_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_read_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;loan_write_refined&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_moved&quot;:{&quot;type&quot;:&quot;None&quot;},&quot;path_uninitialized&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;permissions&quot;:{&quot;drop&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;read&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true},&quot;write&quot;:{&quot;type&quot;:&quot;High&quot;,&quot;value&quot;:true}},&quot;type_droppable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:false},&quot;type_writeable&quot;:{&quot;type&quot;:&quot;None&quot;,&quot;value&quot;:true}}]],&quot;to&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}}}]}]}}]}" data-config="{&quot;boundaries&quot;:&quot;true&quot;,&quot;shouldFail&quot;:&quot;true&quot;,&quot;stepper&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>If you want to review permissions and references, re-read <a href="ch04-02-references-and-borrowing.html">Chapter 4.2</a>.</p>
<h4 id="connecting-ownership-between-compile-time-and-runtime"><a class="header" href="#connecting-ownership-between-compile-time-and-runtime">Connecting Ownership between Compile-time and Runtime</a></h4>
<p>Rust’s permissions are designed to prevent undefined behavior. For example, one kind of undefined behavior is a <strong>use-after-free</strong> where freed memory is read or written. Immutable borrows remove the <span class="perm write">W</span> permission to avoid use-after-free, like in this case:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet mut v = vec![1, 2, 3];\nlet n = &amp;v[0];\nv.push(4);\nprintln!(\&quot;{n}\&quot;);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,6],&quot;interp&quot;:{&quot;state_locations&quot;:[53,64,81]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;interpreter&quot;]" data-responses="{&quot;interpreter&quot;:{&quot;Ok&quot;:{&quot;result&quot;:{&quot;type&quot;:&quot;Error&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;PointerUseAfterFree&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}},&quot;steps&quot;:[{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:0},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:26,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:1}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;n&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:14,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:4}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:4}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:6}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:4}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;n&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:10,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:4}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:4}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:6}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:4}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;n&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:15,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}},&quot;name&quot;:&quot;main&quot;}]}}]}}}" data-config="{&quot;shouldFail&quot;:&quot;true&quot;,&quot;horizontal&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>Another kind of undefined behavior is a <strong>double-free</strong> where memory is freed twice. Dereferences of references to non-copyable data do not have the <span class="perm own">O</span> permission to avoid double-frees, like in this case:</p>
<div class="aquascope-embed" data-code="&quot;fn main() {\nlet v = vec![1, 2, 3];\nlet v_ref: &amp;Vec&lt;i32&gt; = &amp;v;\nlet v2 = *v_ref;\ndrop(v2);\ndrop(v);\n}&quot;" data-annotations="{&quot;hidden_lines&quot;:[1,7],&quot;interp&quot;:{&quot;state_locations&quot;:[78,88,97]},&quot;stepper&quot;:{&quot;focused_lines&quot;:[],&quot;focused_paths&quot;:{}},&quot;boundaries&quot;:{&quot;focused_lines&quot;:[]}}" data-operations="[&quot;interpreter&quot;]" data-responses="{&quot;interpreter&quot;:{&quot;Ok&quot;:{&quot;result&quot;:{&quot;type&quot;:&quot;Error&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;PointerUseAfterFree&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}},&quot;steps&quot;:[{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:0},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:22,&quot;line&quot;:1},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:1}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;v&quot;}}},&quot;range&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:26,&quot;line&quot;:2},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:2}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[{&quot;type&quot;:&quot;Array&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;All&quot;,&quot;value&quot;:[{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:1},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:2},{&quot;type&quot;:&quot;Int&quot;,&quot;value&quot;:3}]}}]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;v&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v2&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[{&quot;type&quot;:&quot;Index&quot;,&quot;value&quot;:0}],&quot;segment&quot;:{&quot;type&quot;:&quot;Heap&quot;,&quot;value&quot;:{&quot;index&quot;:0}}},&quot;range&quot;:null}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:16,&quot;line&quot;:3},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:3}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;v&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[[]],&quot;name&quot;:&quot;v2&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:9,&quot;line&quot;:4},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:4}},&quot;name&quot;:&quot;main&quot;}]}},{&quot;heap&quot;:{&quot;locations&quot;:[]},&quot;stack&quot;:{&quot;frames&quot;:[{&quot;body_span&quot;:{&quot;end&quot;:{&quot;column&quot;:1,&quot;line&quot;:6},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:0}},&quot;locals&quot;:[{&quot;moved_paths&quot;:[[]],&quot;name&quot;:&quot;v&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}},{&quot;moved_paths&quot;:[],&quot;name&quot;:&quot;v_ref&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Pointer&quot;,&quot;value&quot;:{&quot;path&quot;:{&quot;parts&quot;:[],&quot;segment&quot;:{&quot;type&quot;:&quot;Stack&quot;,&quot;value&quot;:{&quot;frame&quot;:0,&quot;local&quot;:&quot;v&quot;}}},&quot;range&quot;:null}}},{&quot;moved_paths&quot;:[[]],&quot;name&quot;:&quot;v2&quot;,&quot;value&quot;:{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:{&quot;type&quot;:&quot;Vec&quot;,&quot;value&quot;:{&quot;len&quot;:3}},&quot;fields&quot;:[[&quot;buf&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;inner&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;ptr&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;pointer&quot;,{&quot;type&quot;:&quot;Unallocated&quot;,&quot;value&quot;:{&quot;alloc_id&quot;:0}}]],&quot;name&quot;:&quot;NonNull&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;Unique&quot;,&quot;variant&quot;:null}}],[&quot;cap&quot;,{&quot;type&quot;:&quot;Adt&quot;,&quot;value&quot;:{&quot;alloc_kind&quot;:null,&quot;fields&quot;:[[&quot;0&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Cap&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVecInner&quot;,&quot;variant&quot;:null}}]],&quot;name&quot;:&quot;RawVec&quot;,&quot;variant&quot;:null}}],[&quot;len&quot;,{&quot;type&quot;:&quot;Uint&quot;,&quot;value&quot;:3}]],&quot;name&quot;:&quot;Vec&quot;,&quot;variant&quot;:null}}}],&quot;location&quot;:{&quot;end&quot;:{&quot;column&quot;:8,&quot;line&quot;:5},&quot;filename&quot;:{&quot;private_use_as_methods_instead&quot;:0},&quot;start&quot;:{&quot;column&quot;:0,&quot;line&quot;:5}},&quot;name&quot;:&quot;main&quot;}]}}]}}}" data-config="{&quot;horizontal&quot;:&quot;true&quot;,&quot;shouldFail&quot;:&quot;true&quot;}" data-no-interact="true"></div>
<p>If you want to review undefined behavior, re-read <a href="ch04-01-what-is-ownership.html">Chapter 4.1</a> and <a href="ch04-03-fixing-ownership-errors.html">Chapter 4.3</a>.</p>
<h3 id="the-rest-of-ownership"><a class="header" href="#the-rest-of-ownership">The Rest of Ownership</a></h3>
<p>As we introduce additional features like structs, enums, and traits, those features will have specific interactions with ownership. This chapter provides the essential foundation for understanding those interactions — the concepts of memory, pointers, undefined behavior, and permissions will help us talk about the more advanced parts of Rust in future chapters.</p>
<p>And don’t forget to take the quizzes if you want to check your understanding!</p>
<div class="quiz-placeholder" data-quiz-name="&quot;ch04-05-ownership-recap&quot;" data-quiz-questions="{&quot;questions&quot;:[{&quot;context&quot;:&quot;The spec calls for the input to be mutated in-place, therefore the most appropriate type signature accepts a mutable reference to the input.\nAn immutable reference or an owned vector are both inappropriate for this spec.\n&quot;,&quot;id&quot;:&quot;1ec0098c-c5dc-46de-a889-b6659c0af757&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;```\nfn round_all(v: &amp;mut Vec&lt;f32&gt;);\n```\n&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;```\nfn round_all(v: &amp;Vec&lt;f32&gt;) -&gt; Vec&lt;f32&gt;;\n```\n&quot;,&quot;```\nfn round_all(v: Vec&lt;f32&gt;);\n```\n&quot;,&quot;```\nfn round_all(v: &amp;Vec&lt;f32&gt;);\n```\n&quot;],&quot;prompt&quot;:&quot;Say you are writing a function with the following spec:\n\n&gt; `round_all` takes as input a list of floating point numbers, and it rounds each number in-place to the nearest integer.\n\nWhich of the following is the most appropriate type signature for a function implementing this spec?\n&quot;}},{&quot;context&quot;:&quot;For `haystack`, the slice type `&amp;[String]` can accept more inputs than `&amp;Vec&lt;String&gt;`, so it is preferred.\nFor `needle`, the target substring does not need to be heap-allocated, so `&amp;str` is preferred to `String`.\nFor the return type, `Vec&lt;String&gt;` is not desirable because it would require cloning the input strings.\n`&amp;[String]` is not desirable because it can only return a contiguous subsequence of the input.\n`Vec&lt;&amp;String&gt;` is the most preferable because it only incurs the cost of allocating the vector, not the strings themselves.\n&quot;,&quot;id&quot;:&quot;f8ca5ab2-0e5d-4c0d-bca2-99e6763ba9c5&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;```\nfn find_contains(haystack: &amp;[String], needle: &amp;str) -&gt; Vec&lt;&amp;String&gt;;\n```\n&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;```\nfn find_contains(haystack: &amp;Vec&lt;String&gt;, needle: String) -&gt; Vec&lt;String&gt;;\n```\n&quot;,&quot;```\nfn find_contains(haystack: &amp;[String], needle: &amp;str) -&gt; Vec&lt;String&gt;;\n```\n&quot;,&quot;```\nfn find_contains(haystack: &amp;Vec&lt;String&gt;, needle: &amp;str) -&gt; &amp;[String];\n```\n&quot;],&quot;prompt&quot;:&quot;Say you are writing a function with the following spec:\n\n&gt; `find_contains` takes as input a collection of strings and a target substring. \n&gt; It returns a list of all the strings in the collection that contain the target substring.\n\nWhich of the following is the most appropriate type signature for a function implementing this spec?\n&quot;}},{&quot;context&quot;:&quot;As discussed in [Chapter 4.3 \&quot;Fixing a Safe Program: Mutating Different Array Elements\&quot;](ch04-03-fixing-ownership-errors.html#fixing-a-safe-program-mutating-different-array-elements), functions like `split_at_mut` are implemented with the `unsafe` feature.\nThis feature doesn't completely disable the borrow checker, but rather enables the use of specific unsafe features like raw pointers.\n&quot;,&quot;id&quot;:&quot;868a4edf-16f0-4191-8aed-835c812b8b25&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;`split_at_mut` uses unsafe code to circumvent the borrow checker with raw pointers&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;`split_at_mut` is a special compiler primitive that cannot be implemented within the language&quot;,&quot;`split_at_mut` uses unsafe code to disable the borrow checker from checking the safety of mutable references&quot;,&quot;`split_at_mut` calls into a C library that can't be analyzed by Rust&quot;],&quot;prompt&quot;:&quot;Rust normally disallows multiple mutable accesses to the same array, even when those accesses are disjoint. \nFor example, this function does not compile:\n\n```\nfn main() {\n  let mut v = vec![0, 1, 2, 3];\n  let (r0, r1) = (&amp;mut v[0..2], &amp;mut v[2..4]);\n  r0[0] += 1;\n  r1[0] += 1;  \n}\n```\n\nHowever, the Rust standard library has a function `slice::split_at_mut` that does permit this functionality:\n\n```\nfn main() {\n  let mut v = vec![0, 1, 2, 3];\n  let (r0, r1) = v.split_at_mut(2);\n  r0[0] += 1;\n  r1[0] += 1;  \n}\n```\n\nWhich of the following best describes how it's possible to implement `split_at_mut`?\n&quot;}},{&quot;context&quot;:&quot;The &lt;span class=\&quot;perm own\&quot;&gt;O&lt;/span&gt; permission represents ownership of an object. There can only exist one owner of an object, so it is important\nthat references cannot transfer ownership of non-copyable types like `String`. If two variables thought they owned\nthe same string, then they would both attempt to deallocate it, causing a double-free.\n&quot;,&quot;id&quot;:&quot;ba32e57a-e5f2-42e4-8cfd-eb265990c690&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;Ownership permits moving, and moving out of a reference can cause a double-free&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;Ownership permits borrowing, and reborrowing `*s_ref` can cause a double-free&quot;,&quot;Ownership permits mutation, and mutating `*s_ref` can cause a use-after-free&quot;,&quot;Ownership permits reading, and reading `*s_ref` can cause a use-after-free&quot;],&quot;prompt&quot;:&quot;Consider the permissions in the following program:\n\n&lt;div class=\&quot;aquascope-embed\&quot; data-code=\&quot;&amp;quot;fn main() {\\nlet s = String::new();\\nlet s_ref = &amp;amp;s;\\nprintln!(\\&amp;quot;{s_ref}\\&amp;quot;);\\n}&amp;quot;\&quot; data-annotations=\&quot;{&amp;quot;hidden_lines&amp;quot;:[1,4,5],&amp;quot;interp&amp;quot;:{&amp;quot;state_locations&amp;quot;:[]},&amp;quot;stepper&amp;quot;:{&amp;quot;focused_lines&amp;quot;:[3],&amp;quot;focused_paths&amp;quot;:{&amp;quot;3&amp;quot;:[{&amp;quot;type&amp;quot;:&amp;quot;Literal&amp;quot;,&amp;quot;value&amp;quot;:&amp;quot;*s_ref&amp;quot;}]}},&amp;quot;boundaries&amp;quot;:{&amp;quot;focused_lines&amp;quot;:[]}}\&quot; data-operations=\&quot;[&amp;quot;permissions&amp;quot;]\&quot; data-responses=\&quot;{&amp;quot;permissions&amp;quot;:[{&amp;quot;Ok&amp;quot;:{&amp;quot;body_range&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:1,&amp;quot;line&amp;quot;:4},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:0}},&amp;quot;boundaries&amp;quot;:[{&amp;quot;actual&amp;quot;:{&amp;quot;drop&amp;quot;:true,&amp;quot;read&amp;quot;:true,&amp;quot;write&amp;quot;:false},&amp;quot;data&amp;quot;:{&amp;quot;is_live&amp;quot;:true,&amp;quot;path_uninitialized&amp;quot;:false,&amp;quot;type_copyable&amp;quot;:false,&amp;quot;type_droppable&amp;quot;:true,&amp;quot;type_writeable&amp;quot;:false},&amp;quot;expected&amp;quot;:{&amp;quot;drop&amp;quot;:false,&amp;quot;read&amp;quot;:true,&amp;quot;write&amp;quot;:false},&amp;quot;location&amp;quot;:{&amp;quot;column&amp;quot;:13,&amp;quot;line&amp;quot;:2}},{&amp;quot;actual&amp;quot;:{&amp;quot;drop&amp;quot;:true,&amp;quot;read&amp;quot;:true,&amp;quot;write&amp;quot;:false},&amp;quot;data&amp;quot;:{&amp;quot;is_live&amp;quot;:true,&amp;quot;path_uninitialized&amp;quot;:false,&amp;quot;type_copyable&amp;quot;:true,&amp;quot;type_droppable&amp;quot;:true,&amp;quot;type_writeable&amp;quot;:false},&amp;quot;expected&amp;quot;:{&amp;quot;drop&amp;quot;:false,&amp;quot;read&amp;quot;:true,&amp;quot;write&amp;quot;:false},&amp;quot;location&amp;quot;:{&amp;quot;column&amp;quot;:11,&amp;quot;line&amp;quot;:3}}],&amp;quot;loan_points&amp;quot;:{&amp;quot;0&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:14,&amp;quot;line&amp;quot;:2},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:12,&amp;quot;line&amp;quot;:2}},&amp;quot;1&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:17,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:10,&amp;quot;line&amp;quot;:3}},&amp;quot;2&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:19,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:3}}},&amp;quot;loan_regions&amp;quot;:{&amp;quot;0&amp;quot;:{&amp;quot;refined_ranges&amp;quot;:[{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:14,&amp;quot;line&amp;quot;:2},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:12,&amp;quot;line&amp;quot;:2}},{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:17,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:10,&amp;quot;line&amp;quot;:3}}],&amp;quot;refiner_point&amp;quot;:{&amp;quot;Loan&amp;quot;:0}},&amp;quot;1&amp;quot;:{&amp;quot;refined_ranges&amp;quot;:[{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:17,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:10,&amp;quot;line&amp;quot;:3}}],&amp;quot;refiner_point&amp;quot;:{&amp;quot;Loan&amp;quot;:1}},&amp;quot;2&amp;quot;:{&amp;quot;refined_ranges&amp;quot;:[{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:19,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:3}}],&amp;quot;refiner_point&amp;quot;:{&amp;quot;Loan&amp;quot;:2}}},&amp;quot;move_points&amp;quot;:{},&amp;quot;move_regions&amp;quot;:{},&amp;quot;steps&amp;quot;:[{&amp;quot;location&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:22,&amp;quot;line&amp;quot;:1},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:22,&amp;quot;line&amp;quot;:1}},&amp;quot;state&amp;quot;:[{&amp;quot;from&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:5,&amp;quot;line&amp;quot;:1},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:4,&amp;quot;line&amp;quot;:1}},&amp;quot;state&amp;quot;:[[&amp;quot;s&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}]],&amp;quot;to&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:9,&amp;quot;line&amp;quot;:2},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:4,&amp;quot;line&amp;quot;:2}}}]},{&amp;quot;location&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:20,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:20,&amp;quot;line&amp;quot;:3}},&amp;quot;state&amp;quot;:[{&amp;quot;from&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:19,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:3}},&amp;quot;state&amp;quot;:[[&amp;quot;s_ref&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}],[&amp;quot;*s_ref&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}]],&amp;quot;to&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:19,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:3}}}]},{&amp;quot;location&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:15,&amp;quot;line&amp;quot;:2},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:15,&amp;quot;line&amp;quot;:2}},&amp;quot;state&amp;quot;:[{&amp;quot;from&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:9,&amp;quot;line&amp;quot;:2},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:4,&amp;quot;line&amp;quot;:2}},&amp;quot;state&amp;quot;:[[&amp;quot;s&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:0},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:0},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}],[&amp;quot;s_ref&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;Low&amp;quot;},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}],[&amp;quot;*s_ref&amp;quot;,{&amp;quot;is_live&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;loan_drop_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_read_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;loan_write_refined&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_moved&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;},&amp;quot;path_uninitialized&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;permissions&amp;quot;:{&amp;quot;drop&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;read&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;High&amp;quot;,&amp;quot;value&amp;quot;:true},&amp;quot;write&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}},&amp;quot;type_droppable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false},&amp;quot;type_writeable&amp;quot;:{&amp;quot;type&amp;quot;:&amp;quot;None&amp;quot;,&amp;quot;value&amp;quot;:false}}]],&amp;quot;to&amp;quot;:{&amp;quot;end&amp;quot;:{&amp;quot;column&amp;quot;:19,&amp;quot;line&amp;quot;:3},&amp;quot;filename&amp;quot;:{&amp;quot;private_use_as_methods_instead&amp;quot;:0},&amp;quot;start&amp;quot;:{&amp;quot;column&amp;quot;:0,&amp;quot;line&amp;quot;:3}}}]}]}}]}\&quot; data-config=\&quot;{&amp;quot;boundaries&amp;quot;:&amp;quot;true&amp;quot;,&amp;quot;stepper&amp;quot;:&amp;quot;true&amp;quot;}\&quot; data-no-interact=\&quot;true\&quot;&gt;&lt;/div&gt;\n\nWhich of the following best explains why `*s_ref` does not have the &lt;span class=\&quot;perm own\&quot;&gt;O&lt;/span&gt; (own) permission?\n&quot;}},{&quot;context&quot;:&quot;The borrow checker always rejects programs with undefined behavior, but may sometimes reject programs without undefined behavior (i.e., are perfectly safe).\nIn technical terms, the borrow checker is a sound and incomplete analysis.\n&quot;,&quot;id&quot;:&quot;3a5f5de5-23a9-49fb-bdb4-acc9c3fbb4a6&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:[&quot;The borrow checker always rejects programs with undefined behavior&quot;,&quot;The borrow checker sometimes rejects programs without undefined behavior&quot;]},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;The borrow checker always accepts programs without undefined behavior&quot;,&quot;The borrow checker sometimes accepts programs with undefined behavior&quot;],&quot;prompt&quot;:&quot;Consider the set of Rust programs that contain no `unsafe` code. \nSelect each of the following statements that is true about the kinds of programs accepted and rejected by the borrow checker:\n&quot;}},{&quot;context&quot;:&quot;This function would cause a double-free on any input.\n&quot;,&quot;id&quot;:&quot;208e0e38-a706-4d96-9809-f0e12f574136&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;This function COULD cause undefined behavior&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;This function could NOT cause undefined behavior&quot;],&quot;prompt&quot;:&quot;The function `extract` is rejected by the borrow checker:\n\n```rust\nfn extract(b: &amp;Box&lt;i32&gt;) -&gt; i32 {\n    let b2: Box&lt;i32&gt; = *b;\n    *b2\n}\n```\n\nImagine that the borrow checker did not reject this function. \nDetermine whether there exists an input such that the function would cause undefined behavior if executed on that input.\n&quot;}},{&quot;context&quot;:&quot;The borrow checker rejects this function because it assumes that `get_first` and `get_second` could return a mutable\nreference to either component of the tuple, and so `fst` and `snd` could possibly point to the same value. But they are\nalways distinct in this program, so this function is actually safe.\n&quot;,&quot;id&quot;:&quot;dcfd54f8-7fe6-4483-aefd-ea95ba5b5eb0&quot;,&quot;type&quot;:&quot;MultipleChoice&quot;,&quot;answer&quot;:{&quot;answer&quot;:&quot;This function could NOT cause undefined behavior&quot;},&quot;prompt&quot;:{&quot;distractors&quot;:[&quot;This function COULD cause undefined behavior&quot;],&quot;prompt&quot;:&quot;The function `transfer_string` is rejected by the borrow checker:\n\n```rust\nfn get_first(strs: &amp;mut (String, String)) -&gt; &amp;mut String {\n    &amp;mut strs.0\n}\n\nfn get_second(strs: &amp;mut (String, String)) -&gt; &amp;mut String {\n    &amp;mut strs.1\n}\n\nfn transfer_string(strs: &amp;mut (String, String)) {\n    let fst = get_first(strs);\n    let snd = get_second(strs);\n    fst.push_str(snd);\n    snd.clear();\n}\n```\n\nImagine that the borrow checker did not reject this function. \nDetermine whether there exists an input such that the function would cause undefined behavior if executed on that input.\n&quot;}}]}" data-quiz-fullscreen="true" data-quiz-cache-answers="true"></div>
<script type="text/javascript" src="aquascope/embed.iife.js"></script><link rel="stylesheet" type="text/css" href="aquascope/style.css">
<script type="text/javascript" src="quiz/quiz-embed.iife.js"></script><link rel="stylesheet" type="text/css" href="quiz/style.css">
<hr>
<ol class="footnote-definition"><li id="footnote-ownership-originally">
<p>In fact, the original invention of ownership types wasn’t about memory safety at all. It was about preventing leaks of mutable references to data structure internals in Java-like languages. If you’re curious to learn more about the history of ownership types, check out the paper <a href="https://dl.acm.org/doi/abs/10.1145/286936.286947">“Ownership Types for Flexible Alias Protection”</a> (Clarke et al. 1998). <a href="#fr-ownership-originally-1">↩</a></p>
</li>
</ol>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch04-04-slices.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch05-00-structs.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch04-04-slices.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch05-00-structs.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="ferris.js"></script>
        <script src="js-extensions/packages/telemetry/dist/index.js"></script>
        <script src="js-extensions/packages/consent-form/dist/index.js"></script>
        <script src="js-extensions/packages/feedback/dist/index.js"></script>


    </div>
    </body>
</html>
